
<div id="main" class="grid-container" ng-controller="SearchController" >
	<!-- Spinner -->
	<span us-spinner="{radius:30, width:8, length: 16}" spinner-on="showSpinner"></span>

	<!-- Open Sidebar Buttons -->
	<a href="#" zf-toggle="searchOptions" class="openOptions button">
		<img zf-iconic="" icon="cog" size="middle" class="">
	</a>
	<a href="#" zf-toggle="savedSearchesPanel" class="openSaves button">
		<img zf-iconic="" icon="cart" size="middle" class="">
	</a>
	<a href="#" zf-toggle="savedSearchesPanel" class="openSaves bookmark button">
		<img zf-iconic="" icon="bookmark" size="middle" class="">
	</a>

	<!-- Search Field -->
	<div class="grid-content searchField">
		<div class="small-12 medium=12 grid-content">
			<label>
				<span class="inline-label">
					<a href="" ng-click="doSearch()" class="button" value="Search">
						<img zf-iconic="" icon="magnifying-glass" size="small">
					</a>
					<input id="searchField" ng-model="searchInput" placeholder="Search Input" my-enter="doSearch()" size="150" type="text">
					<a href="#" ng-click="saveLastSearch()" class="button small saveSearchNotificationLink" title="Save Search"
					   content="Saved: {{searchInput}}" color="success" autoclose="2500" zf-notify="save-notification-search">
						<img zf-iconic="" icon="circle-check" size="small">Save
					</a>
					<div class="searchStats" title="{{queryString}}" ng-if="Response.took" zf-open="showElasticJsonRequestModal">
						&nbsp;&nbsp;<img zf-iconic="" icon="dashboard" size="small"> <span>{{Response.took}} ms</span> <br/>
						&nbsp;&nbsp;<img zf-iconic="" icon="document" size="small"> <span>{{Response.hits.total}} hits</span>
					</div>
				</span>
			</label>
		</div>
		<zf-notification-set id="save-notification-search" position="top-left"></zf-notification-set>
		<zf-notification-set id="save-notification-options" position="top-right"></zf-notification-set>
		<zf-notification-static id="save-notification-whisper" color="success" zf-advise="" title="Whisper message copied." autoclose=2000>
		</zf-notification-static>
		
		<!--<a href="#" zf-toggle="savedSearchesPanel" class="button small absoluteNavBtn savedSearches">Show saved Searches/Items</a>-->
		<a href="#" ng-click="scrollToTop()" class="button small absoluteNavBtn scrollTop">Scroll Top</a>

		<!-- bad search input accordion -->
		<div ng-if="badSearchInputTerms.length" class="badSearchInputTerms">
			<zf-accordion>
				<zf-accordion-item title="Invalid Search Terms">
					<ul>
						<li ng-repeat="badTerm in badSearchInputTerms"><span>{{badTerm}}</span>
					</ul>
				</zf-accordion-item>
			</zf-accordion>
		</div>

		<!-- search terms guide accordion -->
		<div>
            <zf-accordion auto-open="false" class="spoiler">
                <zf-accordion-item title="Terms Guide">
                    <p>First thing is to set the league you want to search. Click the <b>cog</b> on the left of the search bar to select your league. The default league is <b>Perandus SC</b>. To learn how to search for common stuff, click the spoiler tags below. Always type the search without quotes.</p>
                    <div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="My first search">
                                <p>I want to search for a ring with at least 70 life, 60 total elemental resistances and 30% increased weapon elemental damage. Well, it's a ring, so we type <b>'ring'</b>. Life is pretty much life, so we add <b>'70life'</b>, total resistances is usually refered as totaleleres or eleres, so we can type any of those: <b>'60eleres'</b>. Increased Elemental Damage with Weapons is refered to as wed, so we add <b>'wed'</b> to our search. That sums up to <b>'ring 70life 60eleres 30wed'</b>.</p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Uniques">
                                <p>If you want to search for a unique item, you simply have to type its name, without spaces.</p><p>Example: If I want a Kaom's Heart, i'll have to type <b>'kaomsheart'</b>, <b>'kaomheart'</b> or <b>kaom'sheart'</b>. As you guys can see, there is space for variations on it. Apostrophes and stuff like 'the' and 'of' are optional.</p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Base Types">
                                <p>If you want to search for a specific base type, you also only have to type its name.</p><p>Example: I want the "My first search" ring to be of a specific base, a Diamond Ring, i'll have to add to our search simply <b>'diamond'</b>: <b>'ring 70life 60eleres 30wed diamond'</b></p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Sockets and Links">
                                <p>If you want to search for sockets and links, it's also pretty easy.</p><p>Example: I want a 5 linked Lightning Coil. I just have to type: <b>'lightningcoil 5l'</b>. But honestly I want it to already come with the colors I need, 2 red, 2 greens and 1 blue. So I type: <b>'lightningcoil 5l 2r 2g 1b'</b>. Why not have all sockets on it? <b>'lightningcoil 6s 5l 2r 2g 1b'</b>.</p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Gems">
                                <p>Searching for gems works in the same way as searching for uniques, type the name of the gem without spaces.</p><p>Example: I want a Blade Vortex: <b>'bladevortex'</b>. I want it to be at least level 18: <b>'bladevortex glvl18'</b>. I also want its quality to be 15+: <b>'bladevortex glvl18 q15'</b></p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Buyouts">
                                <p>You can also add b/o's to your search, if you only want to see items under a determined price.</p><p>Example: I want a 6l Vaal Regalia for 1 exalt. <b>'vaalregalia 6l 1ex'</b></p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Talismans">
                                <p>Looking for a talisman? You just have to type its name along with the other parameters.</p><p>Example: <b>'ashscale 10firedmg 70life 20res'</b></p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Excluding results from search">
                                <p>If you don't want an item to have a specific mod, life life because you're CI, you just need to type <b>'-life'</b> and the results will only display items without life. You can negate any existing search term, so if you want a nice mace but doesn't want to see Voidhomes, you just have to type <b>'-voidhome'</b></p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
					<div>
                        <zf-accordion auto-open="false" class="spoiler">
                            <zf-accordion-item title="Searching for an item OR another">
                                <p>Exile Tools makes a lot of apparently impossible searches possible. If you need gloves OR boots with 80eleres and 90life, <b>(gloves or boots) 90life 80eleres</b>. Notice that you need to put the items inside parens. You can even do advanced searches like <b>((25fireres 25coldres 25lightres 80res) OR (50res 20int)) -unique</b></p>
                            </zf-accordion-item>
                        </zf-accordion>
                    </div>
                </zf-accordion-item>
            </zf-accordion>
        </div>
		
		<!-- search samples accordion -->
		<div ng-if="!Response">
			<zf-accordion class="sampleSearches">
				<zf-accordion-item title="Sample Searches">
					<ol>
						<li><a href="http://exiletrade.github.io/?q=(gloves%20or%20helm)%2050life%2060eleres&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">(gloves or helm) 50life 60eleres</a></li>
						<li><a href="http://exiletrade.github.io/?q=350pdps%20mace%20-voidhome%2010c&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">350pdps mace -voidhome 10c</a></li>
						<li><a href="http://exiletrade.github.io/?q=ring%2020-30fireres%2020manaregen%2020str&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">ring 20-30fireres 20manaregen 20str</a></li>
						<li><a href="http://exiletrade.github.io/?q=sword%20300pdps%20-flatacc%201ex&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">sword 300pdps -flatacc 1ex</a></li>
						<li><a href="http://exiletrade.github.io/?q=((25fireres%2025coldres%2025lightres%2080res)%20OR%20(50res%2020int))%20-unique&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">((25fireres 25coldres 25lightres 80res) OR (50res 20int)) -unique</a></li>
						<li><a href="http://exiletrade.github.io/?q=voidmanipulation&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">voidmanipulation</a></li>
						<li><a href="http://exiletrade.github.io/?q=pureev%205l%20chest&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50"pureev 5l chest</a></li>
						<li><a href="http://exiletrade.github.io/?q=24leveling&sortKey=shop.chaosEquiv&sortOrder=asc&limit=50">24leveling</a></li>
					</ol>
				</zf-accordion-item>
			</zf-accordion>
		</div>

		<!-- Hidden Options, other the checkboxes in sidebar don't work -->
		<div class="grid-block search-options" ng-show="false">
			<span class="inline-label">
				<div class="switch small">
					<input type="checkbox" ng-model="options.switchPseudoMods" id="switch-pseudoMods">
					<label for="switch-pseudoMods"></label>
				</div>

				<label class="label-pseudoMods">Show PseudoMods</label>
			</span>
			<span class="inline-label">
				<div class="switch small">
					<input type="checkbox" ng-model="options.showAdvancedStats" id="showAdvancedStats">
					<label for="showAdvancedStats"></label>
				</div>

				<label class="label-advancedStats">Show Advanced Item Stats</label>
			</span>
			<span class="inline-label">
				<div class="switch small">
					<input type="checkbox" ng-model="options.switchItemsPerRow" id="switch-itemsPerRow"
						   ng-true-value="" ng-false-value="" ng-change="stateChanged()">
					<label for="switch-itemsPerRow"></label>
				</div>

				<label class="label-pseudoMods">1 item per Row</label>
			</span>
		</div>

		<!-- Saved Searches / Items Sidebar -->
		<div zf-panel="" id="savedSearchesPanel" position="right">
			<a zf-close="" class="close-button ng-scope">×</a>

			<zf-accordion class="saved-search">
				<zf-accordion-item title="Saved Searches">
					<section class="block-list">
						<ul>
							<li class="" ng-repeat="data in savedSearchesList">
								<a href="#" ng-model="searchInput" ng-click="doSavedSearch(data)">{{data}}</a>
								<img zf-iconic="" icon="ban" size="small" class="" ng-click="removeSearchFromList(data)">
							</li>
						</ul>
					</section>
				</zf-accordion-item>
				<zf-accordion-item title="Saved Items">
					<section class="block-list">
						<ul>
							<li class="" ng-repeat="data in savedItemsList">
								<a href="#" ng-click="requestSavedItem(data.itemId)" zf-open="showItemModal">{{data.itemDescription}}</a>
								<img zf-iconic="" icon="ban" size="small" class="" ng-click="removeItemFromList(data.itemId)">
							</li>
						</ul>
					</section>
				</zf-accordion-item>
			</zf-accordion>
		</div>


		<!-- Show Options Sidebar -->
		<div zf-panel="" id="searchOptions">
			<a href="#" zf-close="" ng-click="saveOptions()" class="button small saveOptionsLink" title="Saved Options."
			   color="success" autoclose="2500" zf-notify="save-notification-options">
				<img zf-iconic="" icon="circle-check" size="small">Save
			</a>
			<a zf-close="" class="close-button ng-scope">×</a>

			<div class="grid-block search-options">
				<section class="block-list">
					<header>Display Options</header>
					<ul>
						<li>
							<span>Show PseudoMods</span>
							<div class="switch small">
								<input type="checkbox" ng-model="options.switchPseudoMods" id="switch-pseudoMods">
								<label for="switch-pseudoMods"></label>
							</div>
						</li>
						<li>
							<span class="label-advancedStats">Show Advanced Item Stats</span>
							<div class="switch small">
								<input type="checkbox" ng-model="options.showAdvancedStats" id="showAdvancedStats">
								<label for="showAdvancedStats"></label>
							</div>
						</li>
						<li>
							<span>Show 1 Item per row</span>
							<div class="switch small">
								<input type="checkbox" ng-model="options.switchItemsPerRow" id="switch-itemsPerRow"
									   ng-true-value="" ng-false-value="" ng-change="">
								<label for="switch-itemsPerRow"></label>
							</div>
						</li>
						<li>
							<span>Online Players Only</span>
							<div class="switch small">
								<input type="checkbox" ng-model="switchOnlinePlayersOnly" id="switch-onlinePlayersOnly"
									ng-change="stateChanged()">
								<label for="switch-onlinePlayersOnly"></label>
							</div>
						</li>
					</ul>
				</section>
				<section class="block-list">
					<header>Search Prefixes</header>
					<ul>
						<li class="with-dropdown">
							<select name="" ng-model="options.buyoutSelect.value" id="option-buyout"
									ng-options="v for v in options.buyoutSelect.options">
							</select>
						</li>
						<li class="with-dropdown">
							<select name="" ng-model="options.verificationSelect.value" id="option-verified"
									ng-options="v for v in options.verificationSelect.options">
							</select>
						</li>
						<li ng-repeat="input in options.searchPrefixInputs track by $index">
							<input type="text" ng-model="input.value" placeholder="Custom prefix">
							<!--<img zf-iconic="" icon="ban" size="small" class="iconic-color-alert" ng-click="removeInputFromList(input)">-->
						</li>
					</ul>
					<a href="" class="button small hollow" ng-click="addInputField()">Add Field</a>
				</section>
				<section class="block-list">
					<header>Select Leagues</header>
					<ul>
						<li class="with-dropdown">
							<select name="" ng-model="options.leagueSelect.value" id="option-league"
								ng-options="v for v in options.leagueSelect.options">
							</select>
						</li>
					</ul>
				</section>
			</div>
		</div>

		<!-- Show Item Modal -->
		<div zf-modal="" id="showItemModal" class="collapse">
			<a zf-close="" class="close-button">×</a>
			<div class="grid-block">
				<div class="grid-content item" ng-repeat="item in lastRequestedSavedItem">
					<div item></div>
				</div>
			</div>
		</div>

		<!-- Show Search Terms Doc Modal -->
		<div zf-modal="" class="wide-json-dialog" id="showSearchTermsDocModal">
			<!--a zf-close="" class="close-button">×</a-->
			<h4>Search Terms</h4>
			<div class="DivWithScroll">
				<table>
					<thead>
						<th>Term</th>
						<th>Translation</th>
					</thead>
					<tbody>
						<tr 
							ng-repeat="(key, value) in termsMap"
							ng-class-odd="'rowOdd'" 
							ng-class-even="'rowEven'">
							<td>{{key}}</td>
							<td>{{value.query}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<!-- Show Disclaimer Modal -->
		<div zf-modal="" id="showDisclaimerModal">
			<a zf-close="" class="close-button">×</a>
			<h3>About</h3>
			<p>This site is fan-made and not affiliated with Grinding Gear Games in any way. ExileTrade is fully open source under GNU General Public License v2.0.</p>
			<p>ExileTrade is powered by <a href="https://github.com/trackpete/exiletools-indexer">ExileTools Indexer Public API</a>.</p>
			<p>Visit our official forum thread at <a href="https://www.pathofexile.com/forum/view-thread/1602257">view-thread/1602257</a>.</p>
			<h5>Support Us</h5>
			<p>Buy us a couple of beer!</p>
			<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=3BULCX8UDSN9S&lc=PH&item_name=Durian%20Open%20Source%20Project&currency_code=USD&bn=PP%2dDonationsBF%3aO6Y32pY%2epng%3aNonHosted">
				<img src="http://i.imgur.com/O6Y32pY.png" />
			</a>
		</div>

		<!-- Show Elastic JSON Request Debug Modal -->
		<div zf-modal="" id="showElasticJsonRequestModal">
			<a zf-close="" class="close-button">×</a>
			<h4>Elastic JSON Request</h4>
			<textarea class="code" rows="30" cols="160">{{elasticJsonRequest}}</textarea>
		</div>

		<hr width=100% size=1>

	</div>
	
	<!-- Searchresults -->
	<div class="grid-content search-results">
		<div class="grid-block search-items large-up-2">
			<div class="grid-content item" ng-repeat="item in Response.hits.hits" ng-style="options.switchItemsPerRow"
				 data-id="{{item._id}}" data-md5sum="{{item._source.md5sum}}" data-uuid="{{item._source.uuid}}">
				<!-- Inserting templates/directives/item.html -->
				<div item></div>
			</div>
		</div>
	</div>
</div>
